# High-Precision-Impulse-Response-Matrix-Generator-Based-on-the-Golden-Ratio-

This repository hosts a scientific computing system in Python designed to generate ultra-high-precision 2x2 Impulse Response (IR) matrices. These matrices implement a Symmetric Reflection Crosstalk Synthesis Model, a digital signal processing (DSP) algorithm aimed at the enhancement and manipulation of the stereophonic field.

The cornerstone of this project is mathematical purity and scientific reproducibility. Unlike conventional audio processors, this generator utilizes arbitrary-precision arithmetic to produce results that are a mathematically pure realization of the underlying theoretical model, eliminating rounding errors and numerical artifacts.

Motivation and Practical Application: Transducer Emulation

The primary motivation behind this project was to explore whether the spatial characteristics and sonic signature of ultra-high-end audio transducers could be emulated on more conventional systems.

A validated use case has been the replication of the spatial presentation of the Warwick Acoustics APERIO electrostatic headphones on a pair of dynamic headphones (Maxell Studio Series). Using the Equalizer APO software, this emulation was achieved by applying two key components:

The phi^1 IR matrix generated by this script, applied via convolution to recreate the characteristic crosstalk and stereo imaging of the APERIO.
A perceptually flat equalization curve to correct the frequency response of the Maxell headphones.

The result was a perceptual match of the sound field and spatial presentation, demonstrating the script's ability to generate precise and complex acoustic transformations that go beyond simple frequency equalization. This generator, therefore, is not just a theoretical tool but a practical platform for research in audio emulation and psychoacoustic correction.

Theoretical and Scientific Model

1. Symmetric Reflection Crosstalk Synthesis Model
The algorithm modifies a stereo signal by synthesizing controlled crosstalk. This simulates how the sound from one channel (left) would reach the opposite ear (right) and vice versa, after a series of early reflections. The model is implemented by injecting a train of four Gaussian impulses (reflections) into the signal paths, following this pattern:

h_LL' = h_LL - reflection_signal
h_LR' = h_LR + reflection_signal
h_RL' = h_RL + reflection_signal
h_RR' = h_RR - reflection_signal

This pattern alters the crosstalk to widen the stereo image without affecting the total energy sum of the channels, thus preserving the original spectral balance.

2. Geometry Based on the Golden Ratio (φ)
The key variable of the model is the distance (R) from which the simulated reflections originate. This script generates 13 distinct IR matrices, each based on a radius R derived from powers of the golden ratio (φ ≈ 1.618). This choice is based on the uniform distribution properties of φ, creating a set of spatial transformations that are mathematically related yet perceptually distinct and pleasing.

High-Precision Methodology

To ensure mathematical purity, the script implements a rigorous high-precision pipeline:

Arbitrary-Precision Arithmetic: It uses Python's Decimal module with over 11,000 digits of precision for all sensitive calculations, ensuring that the radius and delay values are mathematically exact.

Rigorous Physico-Acoustic Model: It calculates the speed of sound based on a thermodynamic model (Cramer) that considers temperature, humidity, and atmospheric pressure for a physically coherent simulation.

High-Fidelity DSP: It implements sub-sample precision time delays using a linear-phase FIR filter (Sinc with a Kaiser window), which prevents phase distortion.

Numerical Identity Guarantee: It includes an explicit post-processing step that corrects residual numerical errors, forcing the model's mathematical identities to hold true with a tolerance close to machine epsilon (the fundamental precision limit of the computer's floating-point arithmetic).

Verifiable and Reproducible Output

For each of the 13 radii, the script generates a self-contained and scientifically verifiable .zip data package, which includes:

Four IR files (.wav): The impulse response matrix (h_LL, h_LR, h_RL, h_RR) in 64-bit floating-point format.

Metadata file (metadata.json): A comprehensive document that serves as a generation certificate, detailing:

The exact value of the radius R to 10,000 decimal places.

All environmental and model parameters.

Results of numerical validations that quantify the precision of the process.

SHA-256 cryptographic hashes of each audio file to ensure the integrity and bit-for-bit reproducibility of the data.

Usage

The script is designed to be run from the command line.

Dependencies:

Python 3.x
NumPy
SoundFile

Execution:

python ir_matrix_generator_phi_v7.py [OPTIONS]

Main Arguments:
--temperature: Specifies the ambient temperature in degrees Celsius.
--humidity: Specifies the relative humidity in percentage.
--pressure: Specifies the atmospheric pressure in kilopascals.
--headroom: Target peak level in dB for normalization.
--output: Directory to store the output packages.

Conclusion

This project offers more than a simple audio effects processor; it is a scientific computing system for creating mathematically pure and verifiable acoustic transformations. Its results can be used as a reference standard in convolution applications, psychoacoustic research, and, as has been demonstrated, in the emulation of the spatial properties of high-fidelity audio systems.
